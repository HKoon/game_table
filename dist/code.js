!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=12)}({12:function(e,t){var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{f(i.next(e))}catch(e){a(e)}}function l(e){try{f(i.throw(e))}catch(e){a(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}f((i=i.apply(e,t||[])).next())}))};function i(e){"FRAME"===e.type&&3===e.children.length&&e.children[2].remove()}function o(){const e=[...figma.currentPage.selection];if(0===e.length)return void figma.notify("Select item or itmes to gather");let t=e[0],n=t.x,o=t.y;const a=t.parent;if(a.removed)return;if("FRAME"!==a.type)return;if(e.length>1){e.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0),t=e[0],n=t.x,o=t.y;for(const t of e)t.x=n,t.y=o,n+=t.width+2,a.appendChild(t);return void figma.closePlugin()}const r=t.name,l=a.children,f=[];for(const e of l)e.name===r&&(f.push(e),i(e),e.x=n,e.y=o,o--);figma.currentPage.selection=f,figma.closePlugin()}if(figma.command&&""!==figma.command&&"reset"!==figma.command){const e=figma.currentPage.selection;""!==figma.root.getPluginData("url")||e.length>0&&""!==e[0].getPluginData("assetNode")?(figma.showUI(__html__,{width:400,height:400}),figma.ui.postMessage({type:"warn"})):"shuffle"===figma.command?function(){const e=figma.currentPage.selection.map(e=>e.id);if(0===e.length)return;const t=figma.getNodeById(e[0]),n=t.parent;let o=t.x,a=t.y;for(let t=0;t<e.length;t++){const r=Math.floor(Math.random()*(e.length-t))+t,l=figma.getNodeById(e[r]);i(l),l.x=o,l.y=a,a--,n.insertChild(t,l);const f=e[r];e[r]=e[t],e[t]=f}figma.notify("Finished shuffling"),figma.closePlugin()}():"flip"===figma.command?function(){const e=figma.currentPage.selection;for(let t of e)if("FRAME"===t.type)if(t.parent.appendChild(t),2===t.children.length){const e=t.children[0].clone();t.appendChild(e)}else 3===t.children.length&&t.children[2].remove();figma.closePlugin()}():"gather"===figma.command||"tidy"===figma.command?o():"show"===figma.command?function(){figma.showUI(__html__,{width:400,height:400});const e=()=>n(this,void 0,void 0,(function*(){const e=figma.currentPage.selection,t=figma.createFrame();t.clipsContent=!1,t.x=-1e8;for(const n of e)if("FRAME"===n.type&&""!==n.getPluginData("gameId")){const e=n.children[0].clone();t.appendChild(e),e.x=n.absoluteTransform[0][2],e.y=n.absoluteTransform[1][2]}let n=null;if(t.children.length>0){const e=figma.group(t.children,t);yield new Promise(e=>setTimeout(e,100)),n=(yield e.exportAsync({format:"PNG",contentsOnly:!1})).reduce((e,t)=>e+String.fromCharCode(t),"")}figma.ui.postMessage({type:"img",uri:n}),t.remove()}));e(),figma.on("selectionchange",e)}():"count"===figma.command&&(figma.notify(`${figma.currentPage.selection.length} selected`),figma.closePlugin())}else!function(){const e=figma.currentPage.selection;if(1!==e.length)return figma.notify("Select exactly 1 frame to start game"),void figma.closePlugin();let t=e[0];if("FRAME"!==t.type)return figma.notify("Must select a frame node"),void figma.closePlugin();t.setRelaunchData({reset:"Reset the game to the default state"}),figma.root.setPluginData("url","");for(const e of t.children)(e.getPluginData("gameId")===t.id||"assets"===e.name&&"COMPONENT"===e.type)&&e.remove();for(const e of figma.root.children)if("Assets"===e.name){let n=100;for(const i of e.children){if("FRAME"!==i.type)continue;let e=null,o=100;for(const a of i.children)if(null===e)e=a;else{if("COMPONENT"===a.type)continue;{const r=figma.createFrame();r.fills=[];const l=e.clone();l.x=0,l.y=0,l.locked=!0,r.name=i.name,r.clipsContent=!1,t.appendChild(r);const f=a.clone();r.appendChild(f),r.appendChild(l),f.x=0,f.y=0,f.locked=!0,r.resize(f.width,f.height),r.setPluginData("gameId",t.id),r.setRelaunchData({shuffle:"",gather:"",flip:"",tidy:"",show:"Only you see the hidden info",count:`Count ${i.name}s`}),r.x=n,r.y=o,o--}}e&&(n+=100+e.width)}}figma.closePlugin()}()}});