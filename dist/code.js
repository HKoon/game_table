!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=12)}({12:function(e,t){var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function l(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}c((i=i.apply(e,t||[])).next())}))};function i(e){"GROUP"===e.type&&e.children.length>0&&"FRAME"===e.children[0].type&&3===(e=e.children[0]).children.length&&e.children[2].remove()}function o(){const e=[...figma.currentPage.selection];if(0===e.length)return void figma.notify("Select item or itmes to gather");let t=e[0],n=t.x,o=t.y;const a=t.parent;if(a.removed)return;if("FRAME"!==a.type)return;if(e.length>1){e.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0),t=e[0],n=t.x,o=t.y;for(const t of e)t.x=n,t.y=o,n+=t.width+2,a.appendChild(t);return void figma.closePlugin()}const r=t.getPluginData("class"),l=a.children,c=[];for(const e of l)e.getPluginData("class")===r&&(c.push(e),i(e),e.x=n,e.y=o,o--);figma.currentPage.selection=c,figma.closePlugin()}if(figma.command&&""!==figma.command&&"reset"!==figma.command){const e=figma.currentPage.selection;""!==figma.root.getPluginData("url")||e.length>0&&""!==e[0].getPluginData("assetNode")?(figma.showUI(__html__,{width:400,height:400}),figma.ui.postMessage({type:"warn"})):"shuffle"===figma.command?function(){const e=figma.currentPage.selection.map(e=>e.id);if(0===e.length)return;const t=figma.getNodeById(e[0]),n=t.parent;let o=t.x,a=t.y;for(let t=0;t<e.length;t++){const r=Math.floor(Math.random()*(e.length-t))+t,l=figma.getNodeById(e[r]);i(l),l.x=o,l.y=a,a--,n.insertChild(t,l);const c=e[r];e[r]=e[t],e[t]=c}figma.notify("Finished shuffling"),figma.closePlugin()}():"flip"===figma.command?function(){const e=figma.currentPage.selection;for(let t of e)if("GROUP"===t.type&&0!==t.children.length&&"FRAME"===t.children[0].type)if(t.parent.appendChild(t),t=t.children[0],2===t.children.length){const e=t.children[0].clone();t.appendChild(e)}else 3===t.children.length&&t.children[2].remove();figma.closePlugin()}():"gather"===figma.command||"tidy"===figma.command?o():"show"===figma.command?function(){figma.showUI(__html__,{width:400,height:400});const e=()=>n(this,void 0,void 0,(function*(){const e=figma.currentPage.selection,t=figma.createFrame();t.clipsContent=!1,t.x=-1e8;for(const n of e)if("GROUP"===n.type&&""!==n.getPluginData("gameId")){if(0===n.children.length||"FRAME"!==n.children[0].type)continue;const e=n.children[0],i=e.children[0].clone();t.appendChild(i),i.x=e.absoluteTransform[0][2],i.y=e.absoluteTransform[1][2]}let n=null;if(t.children.length>0){const e=figma.group(t.children,t);yield new Promise(e=>setTimeout(e,100)),n=(yield e.exportAsync({format:"PNG",contentsOnly:!1})).reduce((e,t)=>e+String.fromCharCode(t),"")}figma.ui.postMessage({type:"img",uri:n}),t.remove()}));e(),figma.on("selectionchange",e)}():"count"===figma.command&&(figma.notify(`${figma.currentPage.selection.length} selected`),figma.closePlugin())}else!function(){const e=figma.currentPage.selection;if(1!==e.length)return figma.notify("Select exactly 1 frame to start game"),void figma.closePlugin();let t=e[0];if("FRAME"!==t.type)return figma.notify("Must select a frame node"),void figma.closePlugin();t.setRelaunchData({reset:"Reset the game to the default state"}),figma.root.setPluginData("url","");for(const e of t.children)(e.getPluginData("gameId")===t.id||"assets"===e.name&&"COMPONENT"===e.type)&&e.remove();let n=0;for(const e of figma.root.children)if("Assets"===e.name){let i=100;for(const o of e.children){if("FRAME"!==o.type)continue;n++;let e=null,a=100;for(const r of o.children)if(null===e)e=r;else{if("COMPONENT"===r.type)continue;{const l=e.clone();l.x=0,l.y=0,l.locked=!0;const c=r.clone();c.x=0,c.y=0,c.locked=!0;const f=figma.createFrame();t.appendChild(f),f.name=o.name,f.fills=[],f.clipsContent=!1,f.appendChild(c),f.appendChild(l),f.resize(c.width,c.height),f.x=i,f.y=a;const s=figma.createRectangle();t.appendChild(s),s.name="----",s.resize(c.width,1),s.x=f.x,s.y=f.y+f.height,s.fills=[];const g=figma.group([f,s],t);g.name=o.name,g.setPluginData("gameId",t.id),g.setPluginData("class",`item-${n}`),g.setRelaunchData({shuffle:"",gather:"",flip:"",tidy:"",show:"Only you see the hidden info",count:`Count ${o.name}s`}),a--}}e&&(i+=100+e.width)}}figma.closePlugin()}()}});